# Product: Budget Bot

## Описание продукта

Budget Bot - это Telegram-бот для автоматизированного ведения личного бюджета. Система позволяет пользователям фиксировать расходы и доходы с минимальными усилиями, используя технологии распознавания чеков (QR-коды) и обработки естественного языка ("умный ввод"). Все данные надежно сохраняются локально и синхронизируются с Google Таблицами для удобной отчетности.

## Основная цель

Создать удобный инструмент для автоматического учета личных финансов, который минимизирует рутинные действия пользователя при внесении транзакций, обеспечивает высокую точность данных и надежность хранения информации.

## Пользовательский опыт

### Ключевые сценарии использования

1. **Сканирование чека**:
   - Пользователь делает фото QR-кода на чеке
   - Бот автоматически распознает сумму, дату, продавца и список товаров
   - Предлагает автоматически определенную категорию на основе ключевых слов и ML-классификатора
   - Пользователь может подтвердить или изменить категорию перед сохранением

2. **Умный ввод транзакции**:
   - Пользователь вводит текст в свободной форме (например, "кофе 300" или "такси 500")
   - Бот автоматически парсит текст, извлекает сумму и комментарий
   - Применяет ML-классификатор для определения категории
   - Предлагает транзакцию для подтверждения

3. **Ручной ввод транзакции**:
   - Пользователь запускает команду `/new_transaction`
   - Бот пошагово запрашивает тип, категорию, сумму и комментарий
   - Предоставляет клавиатуру с выбором категорий для удобства

4. **Просмотр истории**:
   - Пользователь запрашивает историю транзакций
   - Бот отображает последние транзакции с пагинацией
   - Предоставляет удобный интерфейс для просмотра и навигации

### Основные фичи

1. **Автоматическое распознавание чеков**: Бот может распознавать чеки по фото QR-кода и автоматически извлекать информацию о покупке.

2. **Умная категоризация**: Используется машинное обучение для автоматического определения категории транзакции на основе ключевых слов и истории покупок.

3. **Ручной выбор категории**: При низкой уверенности в автоматическом определении категории, пользователю предлагается выбрать подходящую категорию из списка.

4. **Редактирование категории**: Возможность изменить автоматически определенную категорию перед сохранением транзакции.

5. **Запись в Google Таблицы**: Все транзакции автоматически записываются в Google Таблицу для дальнейшего анализа.

6. **Обучение на основе ключевых слов**: Система запоминает ключевые слова для каждой категории, чтобы улучшить точность будущих распознаваний.

7. **Поддержка доходов и расходов**: Бот различает типы транзакций и позволяет вести учет как расходов, так и доходов.

8. **Валидация данных**: Проверка корректности вводимых данных (сумма, размер изображения и т.д.).

9. **Обработка ошибок**: Надежная обработка различных видов ошибок (сетевые, API, файловые).

10. **Многопользовательская поддержка**: Возможность ограничения доступа к боту определенным пользователям.

11. **Безопасность**: Реализована система ограничения доступа через ALLOWED_USER_IDS, обеспечивающая доступ только авторизованным пользователям.

## Проблемы, которые решает продукт

1. **Минимизация рутины**: Сокращение времени на внесение транзакций за счет автоматизации (сканирование чеков, парсинг текста).

2. **Точность данных**: Исключение ошибок ручного ввода и дублирования.

3. **Надежность**: Обеспечение сохранности данных даже при отсутствии связи (Local-First архитектура).

4. **Аналитика**: Предоставление структурированных данных в Google Sheets для построения графиков и отчетов.

## Основные сущности

1. **Транзакция**: Основная единица учета, содержащая тип (доход/расход), категорию, сумму, комментарий, дату, время, имя пользователя, продавца, список товаров и способ оплаты.

2. **Категория**: Группировка транзакций по типу расходов или доходов (например, "Продукты", "Транспорт", "Зарплата").

3. **Чек**: Документ, содержащий информацию о покупке, который может быть распознан по QR-коду.

4. **Ключевые слова**: Слова и фразы, ассоциированные с определенными категориями для автоматического определения.

## Взаимодействие с пользователем

- **Команды**: `/start`, `/new_transaction`, `/test_sheets`, `/history`
- **Клавиатура**: Кнопки для быстрого доступа к основным функциям
- **Inline-клавиатуры**: Для выбора категорий, типа транзакции, навигации по истории
- **FSM (Конечный автомат)**: Для пошагового ввода транзакций
- **Обработка изображений**: Для распознавания QR-кодов чеков
- **Парсинг текста**: Для умного ввода транзакций