# Technology Stack: Budget Bot

## Язык программирования
- **Python 3.11+** - основной язык разработки

## Фреймворки и библиотеки
- **aiogram 3.x** - фреймворк для создания Telegram-ботов с поддержкой asyncio
- **Pydantic** - валидация данных и работа с моделями
- **aiosqlite** - асинхронная работа с SQLite базой данных
- **gspread-asyncio** - асинхронная работа с Google Sheets API

## Базы данных
- **SQLite** - локальное хранение данных с использованием подхода "Local-First"

## Облачные сервисы
- **Google Sheets API** - хранение и анализ данных в облаке

## Обработка естественного языка и машинное обучение
- **pymorphy3** - морфологический анализ русского языка
- **TF-IDF classifier** - классификация транзакций по категориям
- Пользовательские модели классификации для определения категорий трат

## Архитектурные паттерны
- **Repository Pattern** - изоляция SQL-запросов в отдельном слое (TransactionRepository, UserRepository)
- **Service Layer** - бизнес-логика в отдельных сервисах
- **Dependency Injection** - внедрение зависимостей через aiogram workflow_data
- **Middleware** - централизованная авторизация и проверка прав доступа
- **FSM (Finite State Machine)** - конечный автомат для управления состоянием интерактивных сессий, используется в админ-панели для навигации между меню

## Безопасность и аутентификация
- **Auth Middleware** - централизованная проверка прав доступа пользователей
- **User Roles** - система ролей (администратор/пользователь) с различными уровнями доступа
- **UserRepository Integration** - проверка пользователей осуществляется через UserRepository
- **Repository Inheritance Pattern** - TransactionRepository наследует UserRepository для расширения функциональности и совместного использования методов работы с базой данных
- **User Object Model** - все обработчики теперь получают объект User (Pydantic модель) вместо словаря, что улучшает типизацию и безопасность
- **Centralized Access Control** - все проверки прав происходят на уровне middleware до попадания в хендлеры

## FSM (Finite State Machine) для админ-панели
- **aiogram.fsm.context.FSMContext** - контекст для управления состоянием админ-панели
- **aiogram.fsm.state.StatesGroup** - группы состояний для различных режимов админ-панели (главное меню, управление пользователями, статистика)
- **AdminStates** - группа состояний админ-панели с FSM (main_menu, users_menu, stats_menu, reports_menu, settings_menu)
- **Callback Query Handlers** - обработчики для управления переходами между состояниями FSM
- **Inline Keyboard Navigation** - навигация по админ-панели с помощью inline-клавиатур и FSM

## Удаленные функции
- **Monthly Limits** - функционал месячных лимитов был удален из системы для упрощения архитектуры и исключения связанной сложности

## Дополнительные зависимости
- **python-dotenv** - управление переменными окружения
- **aiohttp** - асинхронные HTTP-запросы
- **pytest** - тестирование
- **matplotlib** - визуализация данных